{"ast":null,"code":"import { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { mimeType } from './mime-type.validator';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../posts.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/material/card\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/material/progress-spinner\";\nimport * as i6 from \"@angular/forms\";\nimport * as i7 from \"@angular/material/form-field\";\nimport * as i8 from \"@angular/material/input\";\nimport * as i9 from \"@angular/material/button\";\n\nfunction PostCreateComponent_mat_spinner_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"mat-spinner\");\n  }\n}\n\nfunction PostCreateComponent_form_2_mat_error_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"Please enter post title.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction PostCreateComponent_form_2_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10);\n    i0.ɵɵelement(1, \"img\", 11);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"src\", ctx_r4.imagePreview, i0.ɵɵsanitizeUrl)(\"alt\", ctx_r4.form.value.title);\n  }\n}\n\nfunction PostCreateComponent_form_2_mat_error_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"Please enter post content.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction PostCreateComponent_form_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"form\", 2);\n    i0.ɵɵlistener(\"submit\", function PostCreateComponent_form_2_Template_form_submit_0_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return ctx_r6.onSavePost();\n    });\n    i0.ɵɵelementStart(1, \"mat-form-field\");\n    i0.ɵɵelement(2, \"input\", 3);\n    i0.ɵɵtemplate(3, PostCreateComponent_form_2_mat_error_3_Template, 2, 0, \"mat-error\", 0);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\");\n    i0.ɵɵelementStart(5, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function PostCreateComponent_form_2_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r7);\n\n      const _r3 = i0.ɵɵreference(8);\n\n      return _r3.click();\n    });\n    i0.ɵɵtext(6, \"Pick Image\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"input\", 5, 6);\n    i0.ɵɵlistener(\"change\", function PostCreateComponent_form_2_Template_input_change_7_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return ctx_r9.onImageFilePicked($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(9, PostCreateComponent_form_2_div_9_Template, 2, 2, \"div\", 7);\n    i0.ɵɵelementStart(10, \"mat-form-field\");\n    i0.ɵɵelement(11, \"textarea\", 8);\n    i0.ɵɵtemplate(12, PostCreateComponent_form_2_mat_error_12_Template, 2, 0, \"mat-error\", 0);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"button\", 9);\n    i0.ɵɵtext(14, \"Save Post\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"formGroup\", ctx_r1.form);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.form.get(\"title\").invalid);\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.imagePreview !== \"\" && ctx_r1.imagePreview && ctx_r1.form.get(\"image\").valid);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.form.get(\"content\").invalid);\n  }\n}\n\nexport class PostCreateComponent {\n  constructor(postsService, route) {\n    this.postsService = postsService;\n    this.route = route;\n    this.enteredTitle = \"\";\n    this.enteredContent = \"\";\n    this.isLoading = false;\n    this.mode = \"create\";\n  }\n\n  ngOnInit() {\n    this.form = new FormGroup({\n      'title': new FormControl(null, {\n        validators: [Validators.required, Validators.minLength(3)]\n      }),\n      'content': new FormControl(null, {\n        validators: [Validators.required]\n      }),\n      'image': new FormControl(null, {\n        validators: [Validators.required],\n        asyncValidators: [mimeType]\n      })\n    });\n    this.route.paramMap.subscribe(paramMap => {\n      if (paramMap.has('postId')) {\n        this.mode = \"edit\";\n        this.postId = paramMap.get('postId');\n        this.isLoading = true;\n        this.postsService.getPost(this.postId).subscribe(postData => {\n          this.isLoading = false;\n          this.post = {\n            id: postData._id,\n            title: postData.title,\n            content: postData.content,\n            imagePath: null\n          };\n          this.form.setValue({\n            title: this.post.title,\n            content: this.post.content\n          });\n        });\n      }\n    });\n  } // onAddPost(form: NgForm) {\n  //   if(form.invalid){\n  //     return;\n  //   }\n  //   this.postsService.addPost(form.value.id ,form.value.title, form.value.content);\n  //   form.resetForm();\n  // }\n\n\n  onSavePost() {\n    // console.log(this.form)\n    if (this.form.invalid) {\n      console.log(this.form);\n      return;\n    }\n\n    this.isLoading = true;\n\n    if (this.mode === 'create') {\n      this.postsService.addPost(this.form.value.id, this.form.value.title, this.form.value.content, this.form.value.image);\n    } else {\n      this.postsService.updatePost(this.postId, this.form.value.title, this.form.value.content);\n    } // this.postsService.addPost(form.value.id ,form.value.title, form.value.content);\n\n\n    this.form.reset();\n  }\n\n  onImageFilePicked(event) {\n    const file = event.target.files[0];\n    this.form.patchValue({\n      image: file\n    });\n    this.form.get('image').updateValueAndValidity(); // console.log(file)\n\n    console.log(this.form);\n    const reader = new FileReader();\n\n    reader.onload = () => {\n      this.imagePreview = reader.result;\n    };\n\n    reader.readAsDataURL(file);\n  }\n\n}\n\nPostCreateComponent.ɵfac = function PostCreateComponent_Factory(t) {\n  return new (t || PostCreateComponent)(i0.ɵɵdirectiveInject(i1.PostsService), i0.ɵɵdirectiveInject(i2.ActivatedRoute));\n};\n\nPostCreateComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: PostCreateComponent,\n  selectors: [[\"app-post-create\"]],\n  decls: 3,\n  vars: 2,\n  consts: [[4, \"ngIf\"], [3, \"formGroup\", \"submit\", 4, \"ngIf\"], [3, \"formGroup\", \"submit\"], [\"matInput\", \"\", \"type\", \"text\", \"formControlName\", \"title\", \"name\", \"title\", \"placeholder\", \"Post Title\"], [\"mat-stroked-button\", \"\", \"type\", \"button\", 3, \"click\"], [\"type\", \"file\", 3, \"change\"], [\"filePicker\", \"\"], [\"class\", \"image-preview\", 4, \"ngIf\"], [\"matInput\", \"\", \"rows\", \"4\", \"formControlName\", \"content\", \"name\", \"content\", \"placeholder\", \"Post Content\"], [\"mat-raised-button\", \"\", \"color\", \"accent\", \"type\", \"submit\"], [1, \"image-preview\"], [3, \"src\", \"alt\"]],\n  template: function PostCreateComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"mat-card\");\n      i0.ɵɵtemplate(1, PostCreateComponent_mat_spinner_1_Template, 1, 0, \"mat-spinner\", 0);\n      i0.ɵɵtemplate(2, PostCreateComponent_form_2_Template, 15, 4, \"form\", 1);\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.isLoading);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.isLoading);\n    }\n  },\n  directives: [i3.MatCard, i4.NgIf, i5.MatProgressSpinner, i6.ɵNgNoValidate, i6.NgControlStatusGroup, i6.FormGroupDirective, i7.MatFormField, i8.MatInput, i6.DefaultValueAccessor, i6.NgControlStatus, i6.FormControlName, i7.MatError, i9.MatButton],\n  styles: [\"mat-card[_ngcontent-%COMP%]{\\r\\n  width: 80%;\\r\\n  margin: 1rem auto;\\r\\n}\\r\\nmat-form-field[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%] {\\r\\n  width: 100%;\\r\\n}\\r\\nmat-spinner[_ngcontent-%COMP%]{\\r\\n  margin:  auto;\\r\\n}\\r\\ninput[type=\\\"file\\\"][_ngcontent-%COMP%]{\\r\\n  visibility: hidden; \\r\\n}\\r\\n.image-preview[_ngcontent-%COMP%]{\\r\\n  height: 5rem;\\r\\n  margin: 1rem 0;\\r\\n}\\r\\n.image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{\\r\\n  height: 100%;\\r\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBvc3QtY3JlYXRlLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxVQUFVO0VBQ1YsaUJBQWlCO0FBQ25CO0FBQ0E7O0VBRUUsV0FBVztBQUNiO0FBQ0E7RUFDRSxhQUFhO0FBQ2Y7QUFDQTtFQUNFLGtCQUFrQjtBQUNwQjtBQUNBO0VBQ0UsWUFBWTtFQUNaLGNBQWM7QUFDaEI7QUFDQTtFQUNFLFlBQVk7QUFDZCIsImZpbGUiOiJwb3N0LWNyZWF0ZS5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsibWF0LWNhcmR7XHJcbiAgd2lkdGg6IDgwJTtcclxuICBtYXJnaW46IDFyZW0gYXV0bztcclxufVxyXG5tYXQtZm9ybS1maWVsZCxcclxudGV4dGFyZWEge1xyXG4gIHdpZHRoOiAxMDAlO1xyXG59XHJcbm1hdC1zcGlubmVye1xyXG4gIG1hcmdpbjogIGF1dG87XHJcbn1cclxuaW5wdXRbdHlwZT1cImZpbGVcIl17XHJcbiAgdmlzaWJpbGl0eTogaGlkZGVuOyBcclxufVxyXG4uaW1hZ2UtcHJldmlld3tcclxuICBoZWlnaHQ6IDVyZW07XHJcbiAgbWFyZ2luOiAxcmVtIDA7XHJcbn1cclxuLmltYWdlLXByZXZpZXcgaW1ne1xyXG4gIGhlaWdodDogMTAwJTtcclxufSJdfQ== */\"]\n});","map":{"version":3,"sources":["C:/Users/kartik.vijayran/Training/AngProject-main/AngProject/src/app/posts/post-create/post-create.component.ts"],"names":["FormControl","FormGroup","Validators","mimeType","i0","i1","i2","i3","i4","i5","i6","i7","i8","i9","PostCreateComponent_mat_spinner_1_Template","rf","ctx","ɵɵelement","PostCreateComponent_form_2_mat_error_3_Template","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","PostCreateComponent_form_2_div_9_Template","ctx_r4","ɵɵnextContext","ɵɵadvance","ɵɵproperty","imagePreview","ɵɵsanitizeUrl","form","value","title","PostCreateComponent_form_2_mat_error_12_Template","PostCreateComponent_form_2_Template","_r7","ɵɵgetCurrentView","ɵɵlistener","PostCreateComponent_form_2_Template_form_submit_0_listener","ɵɵrestoreView","ctx_r6","onSavePost","ɵɵtemplate","PostCreateComponent_form_2_Template_button_click_5_listener","_r3","ɵɵreference","click","PostCreateComponent_form_2_Template_input_change_7_listener","$event","ctx_r9","onImageFilePicked","ctx_r1","get","invalid","valid","PostCreateComponent","constructor","postsService","route","enteredTitle","enteredContent","isLoading","mode","ngOnInit","validators","required","minLength","asyncValidators","paramMap","subscribe","has","postId","getPost","postData","post","id","_id","content","imagePath","setValue","console","log","addPost","image","updatePost","reset","event","file","target","files","patchValue","updateValueAndValidity","reader","FileReader","onload","result","readAsDataURL","ɵfac","PostCreateComponent_Factory","t","ɵɵdirectiveInject","PostsService","ActivatedRoute","ɵcmp","ɵɵdefineComponent","type","selectors","decls","vars","consts","template","PostCreateComponent_Template","directives","MatCard","NgIf","MatProgressSpinner","ɵNgNoValidate","NgControlStatusGroup","FormGroupDirective","MatFormField","MatInput","DefaultValueAccessor","NgControlStatus","FormControlName","MatError","MatButton","styles"],"mappings":"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","sourcesContent":["import { FormControl, FormGroup, Validators } from '@angular/forms';\r\nimport { mimeType } from './mime-type.validator';\r\nimport * as i0 from \"@angular/core\";\r\nimport * as i1 from \"../posts.service\";\r\nimport * as i2 from \"@angular/router\";\r\nimport * as i3 from \"@angular/material/card\";\r\nimport * as i4 from \"@angular/common\";\r\nimport * as i5 from \"@angular/material/progress-spinner\";\r\nimport * as i6 from \"@angular/forms\";\r\nimport * as i7 from \"@angular/material/form-field\";\r\nimport * as i8 from \"@angular/material/input\";\r\nimport * as i9 from \"@angular/material/button\";\r\nfunction PostCreateComponent_mat_spinner_1_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelement(0, \"mat-spinner\");\r\n} }\r\nfunction PostCreateComponent_form_2_mat_error_3_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"mat-error\");\r\n    i0.ɵɵtext(1, \"Please enter post title.\");\r\n    i0.ɵɵelementEnd();\r\n} }\r\nfunction PostCreateComponent_form_2_div_9_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"div\", 10);\r\n    i0.ɵɵelement(1, \"img\", 11);\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const ctx_r4 = i0.ɵɵnextContext(2);\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵproperty(\"src\", ctx_r4.imagePreview, i0.ɵɵsanitizeUrl)(\"alt\", ctx_r4.form.value.title);\r\n} }\r\nfunction PostCreateComponent_form_2_mat_error_12_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"mat-error\");\r\n    i0.ɵɵtext(1, \"Please enter post content.\");\r\n    i0.ɵɵelementEnd();\r\n} }\r\nfunction PostCreateComponent_form_2_Template(rf, ctx) { if (rf & 1) {\r\n    const _r7 = i0.ɵɵgetCurrentView();\r\n    i0.ɵɵelementStart(0, \"form\", 2);\r\n    i0.ɵɵlistener(\"submit\", function PostCreateComponent_form_2_Template_form_submit_0_listener() { i0.ɵɵrestoreView(_r7); const ctx_r6 = i0.ɵɵnextContext(); return ctx_r6.onSavePost(); });\r\n    i0.ɵɵelementStart(1, \"mat-form-field\");\r\n    i0.ɵɵelement(2, \"input\", 3);\r\n    i0.ɵɵtemplate(3, PostCreateComponent_form_2_mat_error_3_Template, 2, 0, \"mat-error\", 0);\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelementStart(4, \"div\");\r\n    i0.ɵɵelementStart(5, \"button\", 4);\r\n    i0.ɵɵlistener(\"click\", function PostCreateComponent_form_2_Template_button_click_5_listener() { i0.ɵɵrestoreView(_r7); const _r3 = i0.ɵɵreference(8); return _r3.click(); });\r\n    i0.ɵɵtext(6, \"Pick Image\");\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelementStart(7, \"input\", 5, 6);\r\n    i0.ɵɵlistener(\"change\", function PostCreateComponent_form_2_Template_input_change_7_listener($event) { i0.ɵɵrestoreView(_r7); const ctx_r9 = i0.ɵɵnextContext(); return ctx_r9.onImageFilePicked($event); });\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵtemplate(9, PostCreateComponent_form_2_div_9_Template, 2, 2, \"div\", 7);\r\n    i0.ɵɵelementStart(10, \"mat-form-field\");\r\n    i0.ɵɵelement(11, \"textarea\", 8);\r\n    i0.ɵɵtemplate(12, PostCreateComponent_form_2_mat_error_12_Template, 2, 0, \"mat-error\", 0);\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelementStart(13, \"button\", 9);\r\n    i0.ɵɵtext(14, \"Save Post\");\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const ctx_r1 = i0.ɵɵnextContext();\r\n    i0.ɵɵproperty(\"formGroup\", ctx_r1.form);\r\n    i0.ɵɵadvance(3);\r\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.form.get(\"title\").invalid);\r\n    i0.ɵɵadvance(6);\r\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.imagePreview !== \"\" && ctx_r1.imagePreview && ctx_r1.form.get(\"image\").valid);\r\n    i0.ɵɵadvance(3);\r\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.form.get(\"content\").invalid);\r\n} }\r\nexport class PostCreateComponent {\r\n    constructor(postsService, route) {\r\n        this.postsService = postsService;\r\n        this.route = route;\r\n        this.enteredTitle = \"\";\r\n        this.enteredContent = \"\";\r\n        this.isLoading = false;\r\n        this.mode = \"create\";\r\n    }\r\n    ngOnInit() {\r\n        this.form = new FormGroup({ 'title': new FormControl(null, {\r\n                validators: [Validators.required, Validators.minLength(3)]\r\n            }),\r\n            'content': new FormControl(null, {\r\n                validators: [Validators.required]\r\n            }),\r\n            'image': new FormControl(null, {\r\n                validators: [Validators.required],\r\n                asyncValidators: [mimeType]\r\n            })\r\n        });\r\n        this.route.paramMap.subscribe((paramMap) => {\r\n            if (paramMap.has('postId')) {\r\n                this.mode = \"edit\";\r\n                this.postId = paramMap.get('postId');\r\n                this.isLoading = true;\r\n                this.postsService.getPost(this.postId).subscribe((postData) => {\r\n                    this.isLoading = false;\r\n                    this.post = {\r\n                        id: postData._id,\r\n                        title: postData.title,\r\n                        content: postData.content,\r\n                        imagePath: null\r\n                    };\r\n                    this.form.setValue({\r\n                        title: this.post.title,\r\n                        content: this.post.content\r\n                    });\r\n                });\r\n            }\r\n        });\r\n    }\r\n    // onAddPost(form: NgForm) {\r\n    //   if(form.invalid){\r\n    //     return;\r\n    //   }\r\n    //   this.postsService.addPost(form.value.id ,form.value.title, form.value.content);\r\n    //   form.resetForm();\r\n    // }\r\n    onSavePost() {\r\n        // console.log(this.form)\r\n        if (this.form.invalid) {\r\n            console.log(this.form);\r\n            return;\r\n        }\r\n        this.isLoading = true;\r\n        if (this.mode === 'create') {\r\n            this.postsService.addPost(this.form.value.id, this.form.value.title, this.form.value.content, this.form.value.image);\r\n        }\r\n        else {\r\n            this.postsService.updatePost(this.postId, this.form.value.title, this.form.value.content);\r\n        }\r\n        // this.postsService.addPost(form.value.id ,form.value.title, form.value.content);\r\n        this.form.reset();\r\n    }\r\n    onImageFilePicked(event) {\r\n        const file = event.target.files[0];\r\n        this.form.patchValue({ image: file });\r\n        this.form.get('image').updateValueAndValidity();\r\n        // console.log(file)\r\n        console.log(this.form);\r\n        const reader = new FileReader;\r\n        reader.onload = () => {\r\n            this.imagePreview = reader.result;\r\n        };\r\n        reader.readAsDataURL(file);\r\n    }\r\n}\r\nPostCreateComponent.ɵfac = function PostCreateComponent_Factory(t) { return new (t || PostCreateComponent)(i0.ɵɵdirectiveInject(i1.PostsService), i0.ɵɵdirectiveInject(i2.ActivatedRoute)); };\r\nPostCreateComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: PostCreateComponent, selectors: [[\"app-post-create\"]], decls: 3, vars: 2, consts: [[4, \"ngIf\"], [3, \"formGroup\", \"submit\", 4, \"ngIf\"], [3, \"formGroup\", \"submit\"], [\"matInput\", \"\", \"type\", \"text\", \"formControlName\", \"title\", \"name\", \"title\", \"placeholder\", \"Post Title\"], [\"mat-stroked-button\", \"\", \"type\", \"button\", 3, \"click\"], [\"type\", \"file\", 3, \"change\"], [\"filePicker\", \"\"], [\"class\", \"image-preview\", 4, \"ngIf\"], [\"matInput\", \"\", \"rows\", \"4\", \"formControlName\", \"content\", \"name\", \"content\", \"placeholder\", \"Post Content\"], [\"mat-raised-button\", \"\", \"color\", \"accent\", \"type\", \"submit\"], [1, \"image-preview\"], [3, \"src\", \"alt\"]], template: function PostCreateComponent_Template(rf, ctx) { if (rf & 1) {\r\n        i0.ɵɵelementStart(0, \"mat-card\");\r\n        i0.ɵɵtemplate(1, PostCreateComponent_mat_spinner_1_Template, 1, 0, \"mat-spinner\", 0);\r\n        i0.ɵɵtemplate(2, PostCreateComponent_form_2_Template, 15, 4, \"form\", 1);\r\n        i0.ɵɵelementEnd();\r\n    } if (rf & 2) {\r\n        i0.ɵɵadvance(1);\r\n        i0.ɵɵproperty(\"ngIf\", ctx.isLoading);\r\n        i0.ɵɵadvance(1);\r\n        i0.ɵɵproperty(\"ngIf\", !ctx.isLoading);\r\n    } }, directives: [i3.MatCard, i4.NgIf, i5.MatProgressSpinner, i6.ɵNgNoValidate, i6.NgControlStatusGroup, i6.FormGroupDirective, i7.MatFormField, i8.MatInput, i6.DefaultValueAccessor, i6.NgControlStatus, i6.FormControlName, i7.MatError, i9.MatButton], styles: [\"mat-card[_ngcontent-%COMP%]{\\r\\n  width: 80%;\\r\\n  margin: 1rem auto;\\r\\n}\\r\\nmat-form-field[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%] {\\r\\n  width: 100%;\\r\\n}\\r\\nmat-spinner[_ngcontent-%COMP%]{\\r\\n  margin:  auto;\\r\\n}\\r\\ninput[type=\\\"file\\\"][_ngcontent-%COMP%]{\\r\\n  visibility: hidden; \\r\\n}\\r\\n.image-preview[_ngcontent-%COMP%]{\\r\\n  height: 5rem;\\r\\n  margin: 1rem 0;\\r\\n}\\r\\n.image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{\\r\\n  height: 100%;\\r\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBvc3QtY3JlYXRlLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxVQUFVO0VBQ1YsaUJBQWlCO0FBQ25CO0FBQ0E7O0VBRUUsV0FBVztBQUNiO0FBQ0E7RUFDRSxhQUFhO0FBQ2Y7QUFDQTtFQUNFLGtCQUFrQjtBQUNwQjtBQUNBO0VBQ0UsWUFBWTtFQUNaLGNBQWM7QUFDaEI7QUFDQTtFQUNFLFlBQVk7QUFDZCIsImZpbGUiOiJwb3N0LWNyZWF0ZS5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsibWF0LWNhcmR7XHJcbiAgd2lkdGg6IDgwJTtcclxuICBtYXJnaW46IDFyZW0gYXV0bztcclxufVxyXG5tYXQtZm9ybS1maWVsZCxcclxudGV4dGFyZWEge1xyXG4gIHdpZHRoOiAxMDAlO1xyXG59XHJcbm1hdC1zcGlubmVye1xyXG4gIG1hcmdpbjogIGF1dG87XHJcbn1cclxuaW5wdXRbdHlwZT1cImZpbGVcIl17XHJcbiAgdmlzaWJpbGl0eTogaGlkZGVuOyBcclxufVxyXG4uaW1hZ2UtcHJldmlld3tcclxuICBoZWlnaHQ6IDVyZW07XHJcbiAgbWFyZ2luOiAxcmVtIDA7XHJcbn1cclxuLmltYWdlLXByZXZpZXcgaW1ne1xyXG4gIGhlaWdodDogMTAwJTtcclxufSJdfQ== */\"] });\r\n"]},"metadata":{},"sourceType":"module"}